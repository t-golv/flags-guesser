import{m as te,s as me,f as ve,g as xe,h as se,j as be,n as ne,t as h,k as he,c as m,S as M,i as f,u as we,o as ie,l as pe,d as q,p as $e,q as A,r as oe,v as _e,e as ye,F as Se,w as D,x as ke,a as v,b as Ce}from"./index-CScCpKqg.js";import{B as le}from"./Button-CKjQtTKP.js";import{f as Le}from"./flags-DM3H5m99.js";var Fe=h("<a>");function Te(e){e=te({inactiveClass:"inactive",activeClass:"active"},e);const[,n]=me(e,["href","state","class","activeClass","inactiveClass","end"]),a=ve(()=>e.href),l=xe(a),r=se(),i=be(()=>{const c=a();if(c===void 0)return[!1,!1];const o=ne(c.split(/[?#]/,1)[0]).toLowerCase(),g=decodeURI(ne(r.pathname).toLowerCase());return[e.end?o===g:g.startsWith(o+"/")||g===o,o===g]});return(()=>{var c=Fe();return he(c,te(n,{get href(){return l()||e.href},get state(){return JSON.stringify(e.state)},get classList(){return{...e.class&&{[e.class]:!0},[e.inactiveClass]:!i()[0],[e.activeClass]:i()[0],...n.classList}},link:"",get"aria-current"(){return i()[1]?"page":void 0}}),!1),c})()}var Ae=h('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/60"><div class="text-8xl font-extrabold">'),Me=h('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/40"><div class="text-8xl font-extrabold text-green-400">GO!');function Ee(e){return[m(M,{get when(){return e.countdown>0},get children(){var n=Ae(),a=n.firstChild;return f(a,()=>e.countdown),n}}),m(M,{get when(){return e.showGo},get children(){return Me()}})]}var Re=h('<div class="absolute bg-black/50 inset-0 z-50 flex items-center justify-center"><div class="p-8 text-center w-[min(620px,92vw)]"><h1 class="text-6xl font-bold mb-4 bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 text-transparent bg-clip-text">GAME OVER</h1><p class="mb-4 text-xl"><span class=text-gray-400>Final streak:</span> üî• <b></b></p><p class="mb-8 text-xl"><span class=text-gray-400>Average speed:</span> <b></b></p><div class="flex flex-col gap-4">');function Ge(e){const n=()=>{const l=e.recent.filter(r=>!r.wrong);return l.length?(l.reduce((r,i)=>r+i.time,0)/l.length).toFixed(2)+"s":"‚Äî"},a=we();return(()=>{var l=Re(),r=l.firstChild,i=r.firstChild,c=i.nextSibling,o=c.firstChild,g=o.nextSibling,t=g.nextSibling,u=c.nextSibling,x=u.firstChild,w=x.nextSibling,y=w.nextSibling,_=u.nextSibling;return f(t,()=>e.lastStreak),f(y,n),f(_,m(le,{class:"bg-purple-600 hover:bg-purple-500",get onClick(){return e.onRestart},children:"Play Again"}),null),f(_,m(le,{onClick:()=>{a("/")},children:"Go back"}),null),l})()}var Ie=h('<aside class="flex lg:flex-col p-4 gap-4 w-56"><div class="bg-slate-900 rounded-lg p-4 text-center"><p class="text-red-500 font-bold">‚ù§Ô∏è LIVES</p><p class="text-2xl font-bold"></p></div><div class="bg-slate-900 rounded-lg p-4 text-center"><p class="text-yellow-400 font-bold">üî• STREAK</p><p class="text-2xl font-bold"></p></div><div class="bg-slate-900 rounded-lg p-4 text-center"><p class="text-purple-300 font-bold">‚è± TIMER</p><p class="text-2xl font-bold">');function je(e){return(()=>{var n=Ie(),a=n.firstChild,l=a.firstChild,r=l.nextSibling,i=a.nextSibling,c=i.firstChild,o=c.nextSibling,g=i.nextSibling,t=g.firstChild,u=t.nextSibling;return f(n,m(Te,{href:"/",class:"bg-slate-900 rounded-lg p-4 text-center rounded-full font-bold cursor-pointer",children:"üèõ HOME"}),a),f(r,()=>e.lives),f(o,()=>e.streak),f(u,()=>(e.timeLeft/1e3).toFixed(2)),n})()}var ze=h('<p class="absolute translate-y-[-50%] translate-x-[-50%] top-[50%] left-[50%] z-2 text-2xl font-bold text-white px-4 py-2 rounded-lg">'),Ne=h('<div class="flex flex-col items-center gap-6"><div class="relative w-[1000px] flex flex-col items-center justify-center"><div class="inline-block bg-black shadow-xl rounded-lg overflow-hidden z-1"><img class="unselectable transition-opacity w-full h-auto max-h-[500px] object-contain"></div><img class="absolute unselectable blur-[7rem] rounded-[100%] min-w-[105%] min-h-[105%] object-contain opacity-25 z-0"></div><input type=text placeholder="Flag name..."class="w-[480px] z-1 px-6 py-4 rounded-4xl bg-slate-800/50 border border-slate-600 text-white text-center text-xl focus:outline-none focus:border-purple-500 disabled:opacity-0"autocomplete=off>');function Oe(e){let n;return ie(()=>{const a=l=>{l.key===";"&&(l.preventDefault(),n?.focus())};window.addEventListener("keydown",a),oe(()=>window.removeEventListener("keydown",a))}),m(M,{get when(){return e.current},get children(){var a=Ne(),l=a.firstChild,r=l.firstChild,i=r.firstChild,c=r.nextSibling,o=l.nextSibling;f(l,m(M,{get when(){return e.revealed},get children(){var t=ze();return f(t,()=>e.revealed),t}}),null),pe(o,"input",e.onInput,!0);var g=n;return typeof g=="function"?_e(g,o):n=o,q(t=>{var u={"scale-90 ":!!e.revealed},x=e.current.flag,w=e.current.name,y=!!e.revealed,_=e.current.flag,S=e.revealed!==null;return t.e=$e(r,u,t.e),x!==t.t&&A(i,"src",t.t=x),w!==t.a&&A(i,"alt",t.a=w),y!==t.o&&i.classList.toggle("opacity-50",t.o=y),_!==t.i&&A(c,"src",t.i=_),S!==t.n&&(o.disabled=t.n=S),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0}),q(()=>o.value=e.input),a}})}ye(["input"]);var Pe=h('<aside class="min-w-75 p-4"><h3 class="text-lg font-bold mb-2">Recent</h3><div class="flex px-10 lg:px-2 flex-col max-w-[90%] gap-2">'),qe=h('<div class="flex relative bg-gradient-to-r from-slate-700 to-transparent gap-4 items-center pl-9 py-4 pr-4 rounded-lg text-sm"><div class="absolute -left-8"><img loading=lazy class="w-14 unselectable border-2 border-slate-700 rounded-sm object-cover h-9"></div><p class="flex-1 text-sm"></p><div>',!0,!1,!1);function De(e){return(()=>{var n=Pe(),a=n.firstChild,l=a.nextSibling;return f(l,m(Se,{get each(){return e.recent},children:r=>(()=>{var i=qe(),c=i.firstChild,o=c.firstChild,g=c.nextSibling,t=g.nextSibling;return f(g,()=>r.name),f(t,(()=>{var u=D(()=>!!r.wrong);return()=>u()?"Lost":`${r.time.toFixed(2)}s`})()),q(u=>{var x=r.flag,w=`${r.wrong?"text-red-400":"text-green-400"}`;return x!==u.e&&A(o,"src",u.e=x),w!==u.t&&ke(t,u.t=w),u},{e:void 0,t:void 0}),i})()})),n})()}const re=Le;function ae(){return re[Math.floor(Math.random()*re.length)]}const ce={};function P(e,n){const a=new Audio(n);ce[e]=a}function L(e){const n=ce[e];n&&(n.currentTime=0,n.play())}var Be=h('<div class="flex h-screen flex-col lg:flex-row text-white"><main class="flex-1 flex flex-col items-center justify-center gap-6 px-6">');function He(){try{return{timeMs:5e3,lives:3,endMode:"infinite",streakGoal:10,...JSON.parse(localStorage.getItem("flag-guess-settings")||"{}")}}catch{return{timeMs:5e3,lives:3,endMode:"infinite",streakGoal:10}}}function Ve(){const e=He(),n=se();let a,l=0,r,i,c,o=0,g=0,t=!0;const[u,x]=v("countdown"),[w,y]=v(0),[_,S]=v(3),[ue,E]=v(!1),[R,C]=v(e.lives),[F,T]=v(0),[G,B]=v([]),[p,H]=v(null),[J,I]=v(null),[K,j]=v(""),[de,U]=v(e.timeMs),[V,W]=v(null),z=s=>B(d=>[s,...d].slice(0,8)),Q=()=>{const s=G().map($=>$.name);let d=null,b=0;do if(d=ae(),b++,b>50)break;while(s.includes(d.name));return d},X=()=>{if(!t)return;x("countdown"),S(3),E(!1);let s=3;r=setInterval(()=>{if(!t)return clearInterval(r);s--,s>0?S(s):(clearInterval(r),S(0),E(!0),i=setTimeout(()=>{E(!1),Y(),L("notification")},600))},1e3)},Y=()=>{t&&(x("playing"),H(J()??ae()),I(null),j(""),W(null),o=performance.now(),g=o+e.timeMs,U(e.timeMs),a?.focus(),l=requestAnimationFrame(Z))},Z=s=>{if(!t||u()!=="playing")return;const d=Math.max(0,g-s);U(d),d<=0?fe():l=requestAnimationFrame(Z)},k=(s=!1,d)=>{W(p().name),j(""),cancelAnimationFrame(l),s||I(Q()),c=setTimeout(()=>{if(s)y(d??F()),x("gameover");else{const b=J()??Q();H(b),Y(),I(null)}},3e3)},fe=()=>{if(!t)return;const s=F();z({name:p().name,flag:p().flag,time:0,wrong:!0}),T(0),R()-1<=0?(L("notification"),C(0),k(!0,s)):(C(d=>d-1),L("wrong"),k())},ee=s=>{if(!t||u()!=="playing"||V()||s.key!=="Enter")return;const d=K().trim().toLowerCase(),b=p().name.toLowerCase(),$=F();if(d===b){L("correct");const N=(performance.now()-o)/1e3;z({name:p().name,flag:p().flag,time:N});const O=$+1;T(O),e.endMode==="streak"&&O>=e.streakGoal?k(!0,O):k()}else L("wrong"),z({name:p().name,flag:p().flag,time:0,wrong:!0}),T(0),R()-1<=0?(C(0),k(!0,$)):(C(N=>N-1),k())},ge=()=>{C(e.lives),T(0),B([]),X()};return Ce(()=>{n.pathname!=="/play"&&(t=!1,cancelAnimationFrame(l),clearInterval(r),clearTimeout(i),clearTimeout(c))}),ie(()=>{P("correct","/sounds/correct.mp3"),P("wrong","/sounds/wrong.mp3"),P("notification","/sounds/notification.mp3"),window.addEventListener("keydown",ee),X()}),oe(()=>{t=!1,cancelAnimationFrame(l),clearInterval(r),clearTimeout(i),clearTimeout(c),window.removeEventListener("keydown",ee)}),(()=>{var s=Be(),d=s.firstChild;return f(s,m(Ee,{get countdown(){return _()},get showGo(){return ue()}}),d),f(s,(()=>{var b=D(()=>u()==="gameover");return()=>b()&&m(Ge,{get lastStreak(){return w()},get recent(){return G()},onRestart:ge})})(),d),f(s,m(je,{get lives(){return R()},get streak(){return F()},get timeLeft(){return de()}}),d),f(d,(()=>{var b=D(()=>u()==="playing");return()=>b()&&m(Oe,{get current(){return p()},get revealed(){return V()},get input(){return K()},onInput:$=>j($.target.value),inputRef:$=>a=$})})()),f(s,m(De,{get recent(){return G()}}),null),s})()}export{Ve as default};

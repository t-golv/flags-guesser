import{m as ee,s as ge,f as me,g as ve,h as ae,j as xe,n as te,t as p,k as he,c as m,S as T,i as d,u as be,o as se,l as pe,d as O,p as we,q as P,r as ie,v as $e,e as _e,F as ye,w as q,x as Se,a as v,b as ke}from"./index-Ds3RcBq-.js";import{B as ne}from"./Button-DrLkS_o6.js";import{f as Ce}from"./flags-D0aYayXO.js";var Le=p("<a>");function Fe(e){e=ee({inactiveClass:"inactive",activeClass:"active"},e);const[,n]=ge(e,["href","state","class","activeClass","inactiveClass","end"]),a=me(()=>e.href),l=ve(a),r=ae(),o=xe(()=>{const s=a();if(s===void 0)return[!1,!1];const f=te(s.split(/[?#]/,1)[0]).toLowerCase(),t=decodeURI(te(r.pathname).toLowerCase());return[e.end?f===t:t.startsWith(f+"/")||t===f,f===t]});return(()=>{var s=Le();return he(s,ee(n,{get href(){return l()||e.href},get state(){return JSON.stringify(e.state)},get classList(){return{...e.class&&{[e.class]:!0},[e.inactiveClass]:!o()[0],[e.activeClass]:o()[0],...n.classList}},link:"",get"aria-current"(){return o()[1]?"page":void 0}}),!1),s})()}var Te=p('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/60"><div class="text-8xl font-extrabold">'),Ae=p('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/40"><div class="text-8xl font-extrabold text-green-400">GO!');function Me(e){return[m(T,{get when(){return e.countdown>0},get children(){var n=Te(),a=n.firstChild;return d(a,()=>e.countdown),n}}),m(T,{get when(){return e.showGo},get children(){return Ae()}})]}var Ee=p('<div class="absolute bg-black/50 inset-0 z-50 flex items-center justify-center"><div class="p-8 text-center w-[min(620px,92vw)]"><h1 class="text-6xl font-bold mb-4 bg-gradient-to-r from-pink-500 via-purple-500 to-indigo-500 text-transparent bg-clip-text">GAME OVER</h1><p class="mb-4 text-xl"><span class=text-gray-400>Final streak:</span> üî• <b></b></p><p class="mb-8 text-xl"><span class=text-gray-400>Average speed:</span> <b></b></p><div class="flex flex-col gap-4">');function Re(e){const n=()=>{const l=e.recent.filter(r=>!r.wrong);return l.length?(l.reduce((r,o)=>r+o.time,0)/l.length).toFixed(2)+"s":"‚Äî"},a=be();return(()=>{var l=Ee(),r=l.firstChild,o=r.firstChild,s=o.nextSibling,f=s.firstChild,t=f.nextSibling,g=t.nextSibling,c=s.nextSibling,x=c.firstChild,w=x.nextSibling,_=w.nextSibling,C=c.nextSibling;return d(g,()=>e.lastStreak),d(_,n),d(C,m(ne,{class:"bg-purple-600 hover:bg-purple-500",get onClick(){return e.onRestart},children:"Play Again"}),null),d(C,m(ne,{onClick:()=>{a("/")},children:"Go back"}),null),l})()}var Ge=p('<aside class="flex lg:flex-col p-4 gap-4 w-56"><div class="bg-slate-900 rounded-lg p-4 text-center"><p class="text-red-500 font-bold">‚ù§Ô∏è LIVES</p><p class="text-2xl font-bold"></p></div><div class="bg-slate-900 rounded-lg p-4 text-center"><p class="text-yellow-400 font-bold">üî• STREAK</p><p class="text-2xl font-bold"></p></div><div class="bg-slate-900 rounded-lg p-4 text-center"><p class="text-purple-300 font-bold">‚è± TIMER</p><p class="text-2xl font-bold">');function Ie(e){return(()=>{var n=Ge(),a=n.firstChild,l=a.firstChild,r=l.nextSibling,o=a.nextSibling,s=o.firstChild,f=s.nextSibling,t=o.nextSibling,g=t.firstChild,c=g.nextSibling;return d(n,m(Fe,{href:"/",class:"bg-slate-900 rounded-lg p-4 text-center font-bold cursor-pointer",children:"üèõ HOME"}),a),d(r,()=>e.lives),d(f,()=>e.streak),d(c,()=>(e.timeLeft/1e3).toFixed(2)),n})()}var Ne=p('<p class="absolute translate-y-[-50%] translate-x-[-50%] top-[50%] left-[50%] z-2 text-2xl font-bold text-white px-4 py-2 rounded-lg">'),je=p('<div class="flex flex-col items-center gap-6"><div class="relative w-[1000px] flex flex-col items-center justify-center"><div class="inline-block bg-black shadow-xl rounded-lg overflow-hidden z-1"><img class="unselectable transition-opacity w-full h-auto max-h-[500px] object-contain"decoding=async></div></div><input type=text placeholder="Flag name..."class="w-[480px] z-1 px-6 py-4 rounded-4xl bg-slate-800/50 border border-slate-600 text-white text-center text-xl focus:outline-none focus:border-purple-500 disabled:opacity-0"autocomplete=off>');function ze(e){let n;return se(()=>{const a=l=>{l.key===";"&&(l.preventDefault(),n?.focus())};window.addEventListener("keydown",a),ie(()=>window.removeEventListener("keydown",a))}),m(T,{get when(){return e.current},get children(){var a=je(),l=a.firstChild,r=l.firstChild,o=r.firstChild,s=l.nextSibling;d(l,m(T,{get when(){return e.revealed},get children(){var t=Ne();return d(t,()=>e.revealed),t}}),null),pe(s,"input",e.onInput,!0);var f=n;return typeof f=="function"?$e(f,s):n=s,O(t=>{var g={"scale-90 ":!!e.revealed},c="/flags-guesser/"+e.current.flag,x=e.current.name,w=!!e.revealed,_=e.revealed!==null;return t.e=we(r,g,t.e),c!==t.t&&P(o,"src",t.t=c),x!==t.a&&P(o,"alt",t.a=x),w!==t.o&&o.classList.toggle("opacity-50",t.o=w),_!==t.i&&(s.disabled=t.i=_),t},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),O(()=>s.value=e.input),a}})}_e(["input"]);var Oe=p('<aside class="min-w-75 p-4"><h3 class="text-lg font-bold mb-2">Recent</h3><div class="flex px-10 lg:px-2 flex-col max-w-[90%] gap-2">'),Pe=p('<div class="flex relative bg-gradient-to-r from-slate-700 to-transparent gap-4 items-center pl-9 py-4 pr-4 rounded-lg text-sm"><div class="absolute -left-8"><img loading=lazy class="w-14 unselectable border-2 border-slate-700 rounded-sm object-cover h-9"></div><p class="flex-1 text-sm"></p><div>',!0,!1,!1);function qe(e){return(()=>{var n=Oe(),a=n.firstChild,l=a.nextSibling;return d(l,m(ye,{get each(){return e.recent},children:r=>(()=>{var o=Pe(),s=o.firstChild,f=s.firstChild,t=s.nextSibling,g=t.nextSibling;return d(t,()=>r.name),d(g,(()=>{var c=q(()=>!!r.wrong);return()=>c()?"Lost":`${r.time.toFixed(2)}s`})()),O(c=>{var x="/flags-guesser/"+r.flag,w=`${r.wrong?"text-red-400":"text-green-400"}`;return x!==c.e&&P(f,"src",c.e=x),w!==c.t&&Se(g,c.t=w),c},{e:void 0,t:void 0}),o})()})),n})()}const le=Ce;function re(){return le[Math.floor(Math.random()*le.length)]}const oe={};function z(e,n){const a=new Audio(n);oe[e]=a}function k(e){const n=oe[e];n&&(n.currentTime=0,n.play())}var De=p('<div class="flex h-screen flex-col lg:flex-row text-white"><main class="flex-1 flex flex-col items-center justify-center gap-6 px-6">');function Be(){try{return{timeMs:5e3,lives:3,endMode:"infinite",streakGoal:10,...JSON.parse(localStorage.getItem("flag-guess-settings")||"{}")}}catch{return{timeMs:5e3,lives:3,endMode:"infinite",streakGoal:10}}}function Ue(){const e=Be(),n=ae();let a,l=0,r,o,s,f=0,t=0,g=!0;const[c,x]=v("countdown"),[w,_]=v(0),[C,A]=v(3),[ce,M]=v(!1),[E,S]=v(e.lives),[L,F]=v(0),[R,D]=v([]),[$,B]=v(null),[H,G]=v(null),[J,I]=v(""),[ue,K]=v(e.timeMs),[U,V]=v(null),N=i=>D(u=>[i,...u].slice(0,8)),W=()=>{const i=R().map(b=>b.name);let u=null,h=0;do if(u=re(),h++,h>50)break;while(i.includes(u.name));return u},Q=()=>{if(!g)return;x("countdown"),A(3),M(!1);let i=3;r=setInterval(()=>{if(!g)return clearInterval(r);i--,i>0?A(i):(clearInterval(r),A(0),M(!0),o=setTimeout(()=>{M(!1),X(),k("notification")},600))},1e3)},X=()=>{g&&(x("playing"),B(H()??re()),G(null),I(""),V(null),f=performance.now(),t=f+e.timeMs,K(e.timeMs),a?.focus(),l=requestAnimationFrame(Y))},Y=i=>{if(!g||c()!=="playing")return;const u=Math.max(0,t-i);K(u),u<=0?de():l=requestAnimationFrame(Y)},y=(i=!1,u)=>{V($().name),I(""),cancelAnimationFrame(l),i||G(W()),s=setTimeout(()=>{if(i)_(u??L()),x("gameover");else{const h=H()??W();B(h),X(),G(null)}},3e3)},de=()=>{if(!g)return;const i=L();N({name:$().name,flag:$().flag,time:0,wrong:!0}),F(0),E()-1<=0?(k("notification"),S(0),y(!0,i)):(S(u=>u-1),k("wrong"),y())},Z=i=>{if(!g||c()!=="playing"||U()||i.key!=="Enter")return;const u=J().trim().toLowerCase(),h=$().name.toLowerCase(),b=L();if(u===h){k("correct");const j=(performance.now()-f)/1e3;N({name:$().name,flag:$().flag,time:j}),F(b+1),e.endMode==="streak"&&b+1>=e.streakGoal?y(!0,b+1):y()}else k("wrong"),N({name:$().name,flag:$().flag,time:0,wrong:!0}),F(0),E()-1<=0?(S(0),y(!0,b)):(S(j=>j-1),y())},fe=()=>{S(e.lives),F(0),D([]),Q()};return ke(()=>{n.pathname!=="/flags-guesser/play"&&(g=!1,cancelAnimationFrame(l),clearInterval(r),clearTimeout(o),clearTimeout(s))}),se(()=>{z("correct","/flags-guesser/sounds/correct.mp3"),z("wrong","/flags-guesser/sounds/wrong.mp3"),z("notification","/flags-guesser/sounds/notification.mp3"),window.addEventListener("keydown",Z),Q()}),ie(()=>{g=!1,cancelAnimationFrame(l),clearInterval(r),clearTimeout(o),clearTimeout(s),window.removeEventListener("keydown",Z)}),(()=>{var i=De(),u=i.firstChild;return d(i,m(Me,{get countdown(){return C()},get showGo(){return ce()}}),u),d(i,(()=>{var h=q(()=>c()==="gameover");return()=>h()&&m(Re,{get lastStreak(){return w()},get recent(){return R()},onRestart:fe})})(),u),d(i,m(Ie,{get lives(){return E()},get streak(){return L()},get timeLeft(){return ue()}}),u),d(u,(()=>{var h=q(()=>c()==="playing");return()=>h()&&m(ze,{get current(){return $()},get revealed(){return U()},get input(){return J()},onInput:b=>I(b.target.value),inputRef:b=>a=b})})()),d(i,m(qe,{get recent(){return R()}}),null),i})()}export{Ue as default};
